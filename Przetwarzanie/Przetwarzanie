# -*- coding: utf-8 -*-
"""2-przetwarzanie.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1coH-Dd1u0kWQBzky85dbOOLiopoypvOI
"""

import pandas as pd
import numpy as np

## importujemy dane z ms excel

dane = pd.read_excel(io = "gospodarstwa.xlsx")
dane.head()

dane_sas = pd.read_sas("baza2005.sas7bdat")
dane_sas.head()

## tworzymy histogram
## dane - wcześniej wprowadzonazmienna
## dochg - wybieram zmienną dochód
## plot - rysuj
## hist - wykres, histogram
## ze zbioru dane wybieram zmienną dochód i rysuję wykres histogram
## bins - podstawowo jak klikniemy TAB w nawiasach hist() to bins jest 10, zmieniamy na 100
dane.dochg.plot.hist(bins = 100)
## silnie asymetrycznie skośny

dane.wydg.plot.hist(bins = 100)
## podstawowo bins = 10

dane.plot.scatter(x = "dochg", y = "wydg")
## scatter = wykres rozrzutu
## dochg = kolumna dochód
## wydg = kolumna wydatków
## nie ma związku liniowego

## funkcja describe
## funkcja value_counts()

dane.wydg.describe()
## dla kolumny wydatków
## funkcja zwraca count - liczba obserwacji, 
## mean - średnia, std - odchylenie stand z próby, min - minimalna wartość, 
## 25% kwartyl 1, 50 kwartyl 2, 75 kwartyl 3, max - wartość maksymalna
## mediana 1700 prawie, a  średnia ponad 2000

dane.describe()
## dla całego zbioru danych

dane.klm.value_counts()
## dla jednej zmiennej - klm
## zwraca liczbę wystąpień poszczególnych wartości i jeszcze je sortuje od najliczniejszej

"""# WYBIERANIE KOLUMN ZE ZBIORU DANYCH"""

dane["klm"]
## tylko w ten sposób można wybrać kolumnę - po jej nazwie, nie po indeksie

dane[["klm", "wydg"]]
## zakres kolumn podajemy w nawiasach kwadratowych; ["c1", "c5"] - (wektor) tak wybieramy z zakresu albo [0 , 4]

## iloc - integer location - wybieranie kolumn i wierszy po indeksach
## loc - location - wybieranie kolumn i wierszy po nazwach
dane.iloc[0] ## wybranie pierwszego wiersza
dane.iloc[[0,1]] ## wybranie dwóch wierszy
dane.iloc[:3] ## wybranie od początku do 3 wiersza włącznie
dane.iloc[10:15, 0:2] ## wiersz od 10 do 15(czyli 14, łącznie 5 wierszy), kolumna od 0 do 2

dane.loc[1] ## wybieramy pierwszy wiersz
dane.loc[1, "woj"] ## wybieramy drugi wiersz z kolumny woj
dane.loc[:, "woj"] ## wybieramy wszystkie wiersze i kolumne woj
dane.loc[:, ["woj", "klm", "wydg"]] ## wszystkie wiersze i 3 kolumny

"""# PRZETWARZANIE WARUNKOWE"""

## funkcja loc albo funkcja query
## w query warunek w formie tekstu ("")
## w loc warunek w formie python ()
## wybieram gosp domowe, które są gospodarstwami ze wsi (czyli klm = 6)
dane.loc[dane["klm"] == 6]
dane.loc[dane.klm == 6] ## alternatywnie można i tak (to jednak to samo)
dane.loc[dane.klm == 6, ["klm", "wydg"]] ## dane.klm wybiera wiersze, po przecinku wybiera kolumny
dane.query("klm == 6") ##wpisujemy nazwę kolumny ale musi być jako tekst
dane.query("klm == 6 & wydg > 1000")
